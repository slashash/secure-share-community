<!-- Wappler include head-page="layouts/access" bootstrap5="local" is="dmx-app" id="resetpassword" appconnect="local" bootstrap_icons="local" components="{dmxValidator:{}}" -->

<meta name="ac:route" content="/reset-password/:token">

<div class="d-flex justify-content-center vh-100 align-items-center flex-column">
  <h2><span>🔐</span>Secure Share</h2>
  <div class="border-0 border-top card m-4 mt-0 shadow p-3">
    <div class="card-body">
      <h4 class="card-title mt-2">Reset Password 🔒</h4>
      <form is="dmx-serverconnect-form" id="formResetPass" method="post" action="/api/access/reset-password" dmx-generator="bootstrap5" dmx-form-type="horizontal" dmx-on:success="notif.success('Password changed.');browser1.goto('/',true,'Login')" dmx-on:error="notif.danger(lastError.response.default('Server error occurred. Please try again.'))" dmx-on:forbidden="browser1.goto('/403-forbidden')" dmx-on:invalid="notif.warning('Invalid credentials.')">
        <input type="hidden" name="token" dmx-bind:value="query.token" required="">
        <div class="mb-3">
          <label for="txtNewPassword" class="form-label">Enter New Password *</label>
          <input type="password" class="form-control" id="txtNewPassword" name="pass" required="" minlength="8" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}">
        </div>
        <div class="mb-3">
          <label for="floatingPassword" class="form-label">Re-enter New Password *</label>
          <input type="password" class="form-control" id="txtReNewPassword" name="pass_confirm" required="" data-rule-equalto="pass">
        </div>

        <p class="fw-bolder mt-2">Password requirements:</p>
        <ul class="p-0" style="list-style-position: inside;">
          <li>Minimum 8 characters long - the more, the better</li>
          <li>At least one lowercase character</li>
          <li>At least one number and one symbol character</li>
        </ul>
        <button class="w-100 btn btn-lg btn-primary mt-1" type="submit" dmx-bind:disabled="state.executing">Set New Password<span class="spinner-border spinner-border-sm ms-2" role="status" dmx-show="state.executing"></span></button>
      </form>
      <p class="text-center mt-2">
        <a href="/" id="LoginLink" internal><i class="bi-chevron-left me-1"></i>Login</a>
      </p>
    </div>
  </div>
</div>